#include "defs.h"
#include "audio.h"
#include "video.h"


int main()
{
	AudioInitialize();
	VideoInitialize();
	PlayMusic("land_s.wav");
	PaintRectangular(0,0,1023,599,&Color_Black);

	while(1)
	{
		//main transaction loop
		if(Music_Read_Permition)
		{
			Music_Read_Permition = 0;
			ReadWavMusic(Music_Play_Now,1);
		}
		if(Video_Update_Permit)
		{
			Video_Update_Permit = 0;
			DrawWave(300,&Color_Black);
			//PaintRectangular(0,300-100,1023,200,&Color_Black);
			queue_header temp_q = Wave_Queue;
			Wave_Queue = Wave_Queue->next;
			ConvertAudioToVideo(GetNowMusicBufferPointer(),
					temp_q->data,AUDIO_BYTES_PER_PERIOD/4);
			DrawWave(300,&Color_Cyan);
		}
	}
}


